package progressbar

import (
	"sync/atomic"
	"time"

	"github.com/vbauerster/mpb/v8"
	"github.com/vbauerster/mpb/v8/decor"
)

var priority atomic.Int32

func Priority() int {
	priority.Add(1)
	return int(priority.Load())
}

var (
	RefreshRate       = mpb.WithRefreshRate(100 * time.Millisecond)
	BarStyleMain      = mpb.BarStyle().Lbound("⡇").Filler("⣿").Rbound("⢸").Tip("⡇", "⣇", "⡧", "⡗", "⡏").Padding("+")
	BarStyleSecondary = mpb.BarStyle().Lbound("[").Filler("=").Rbound("]").Tip(">").Padding(" ")
)

var (
	Spinner = decor.OnComplete(SpinnerProgress, SpinnerComplete)
	ETA     = decor.OnComplete(decor.AverageETA(decor.ET_STYLE_GO, decor.WC{C: decor.DextraSpace}), "DONE") // with Bar.EwmaIncrement
)

var (
	SpinnerComplete = "⣏⣹"
	SpinnerProgress = decor.Spinner(Spinners)
	Spinners        = []string{
		`⠁⠀`,
		`⠈⠁`, `⠀⠙`, `⠀⢸`, `⢀⣰`, `⣄⣠`,
		`⣇⣀`, `⣏⡁`, `⣏⠙`, `⡏⢹`, `⢏⣹`,
		`⣏⣹`,
		`⣏⣩`, `⣏⡙`, `⡏⠹`, `⠋⢹`, `⠈⣹`,
		`⢀⣸`, `⣀⣠`, `⣄⡀`, `⡆⠀`, `⠃⠀`,

		`⠈⠀`,
		`⠀⠉`, `⠀⠸`, `⠀⣰`, `⣀⣠`, `⣆⣀`,
		`⣏⡀`, `⣏⠉`, `⡏⠹`, `⠏⣹`, `⣋⣹`,
		`⣏⣹`,
		`⣏⣙`, `⣏⠹`, `⠏⢹`, `⠉⣹`, `⢀⣹`,
		`⣀⣰`, `⣄⣀`, `⣆⠀`, `⠇⠀`, `⠉⠀`,

		`⠀⠁`,
		`⠀⠘`, `⠀⢰`, `⢀⣠`, `⣄⣀`, `⣇⡀`,
		`⣏⠁`, `⡏⠙`, `⠏⢹`, `⢋⣹`, `⣍⣹`,
		`⣏⣹`,
		`⣏⡹`, `⡏⢹`, `⠋⣹`, `⢈⣹`, `⣀⣸`,
		`⣄⣠`, `⣆⡀`, `⡇⠀`, `⠋⠀`, `⠈⠁`,

		`⠀⠈`,
		`⠀⠰`, `⠀⣠`, `⣀⣀`, `⣆⡀`, `⣏⠀`,
		`⡏⠉`, `⠏⠹`, `⠋⣹`, `⣉⣹`, `⣎⣹`,
		`⣏⣹`,
		`⣏⢹`, `⠏⣹`, `⢉⣹`, `⣀⣹`, `⣄⣰`,
		`⣆⣀`, `⣇⠀`, `⠏⠀`, `⠉⠁`, `⠀⠉`,

		`⠀⠐`,
		`⠀⢠`, `⢀⣀`, `⣄⡀`, `⣇⠀`, `⡏⠁`,
		`⠏⠙`, `⠋⢹`, `⢉⣹`, `⣌⣹`, `⣇⣹`,
		`⣏⣹`,
		`⡏⣹`, `⢋⣹`, `⣈⣹`, `⣄⣸`, `⣆⣠`,
		`⣇⡀`, `⡏⠀`, `⠋⠁`, `⠈⠉`, `⠀⠘`,

		`⠀⠠`,
		`⠀⣀`, `⣀⡀`, `⣆⠀`, `⡏⠀`, `⠏⠉`,
		`⠋⠹`, `⠉⣹`, `⣈⣹`, `⣆⣹`, `⣏⣸`,
		`⣏⣹`,
		`⢏⣹`, `⣉⣹`, `⣄⣹`, `⣆⣰`, `⣇⣀`,
		`⣏⠀`, `⠏⠁`, `⠉⠉`, `⠀⠙`, `⠀⠰`,

		`⠀⢀`,
		`⢀⡀`, `⣄⠀`, `⡇⠀`, `⠏⠁`, `⠋⠙`,
		`⠉⢹`, `⢈⣹`, `⣄⣹`, `⣇⣸`, `⣏⣱`,
		`⣏⣹`,
		`⣋⣹`, `⣌⣹`, `⣆⣸`, `⣇⣠`, `⣏⡀`,
		`⡏⠁`, `⠋⠉`, `⠈⠙`, `⠀⠸`, `⠀⢠`,

		`⠀⡀`,
		`⣀⠀`, `⡆⠀`, `⠏⠀`, `⠋⠉`, `⠉⠹`,
		`⠈⣹`, `⣀⣹`, `⣆⣸`, `⣏⣰`, `⣏⣩`,
		`⣏⣹`,
		`⣍⣹`, `⣆⣹`, `⣇⣰`, `⣏⣀`, `⣏⠁`,
		`⠏⠉`, `⠉⠙`, `⠀⠹`, `⠀⢰`, `⠀⣀`,

		`⢀⠀`,
		`⡄⠀`, `⠇⠀`, `⠋⠁`, `⠉⠙`, `⠈⢹`,
		`⢀⣹`, `⣄⣸`, `⣇⣰`, `⣏⣡`, `⣏⣙`,
		`⣏⣹`,
		`⣎⣹`, `⣇⣸`, `⣏⣠`, `⣏⡁`, `⡏⠉`,
		`⠋⠙`, `⠈⠹`, `⠀⢸`, `⠀⣠`, `⢀⡀`,

		`⡀⠀`,
		`⠆⠀`, `⠋⠀`, `⠉⠉`, `⠈⠹`, `⠀⣹`,
		`⣀⣸`, `⣆⣰`, `⣏⣠`, `⣏⣉`, `⣏⡹`,
		`⣏⣹`,
		`⣇⣹`, `⣏⣰`, `⣏⣁`, `⣏⠉`, `⠏⠙`,
		`⠉⠹`, `⠀⢹`, `⠀⣰`, `⢀⣀`, `⣀⠀`,

		`⠄⠀`,
		`⠃⠀`, `⠉⠁`, `⠈⠙`, `⠀⢹`, `⢀⣸`,
		`⣄⣰`, `⣇⣠`, `⣏⣁`, `⣏⡙`, `⣏⢹`,
		`⣏⣹`,
		`⣏⣸`, `⣏⣡`, `⣏⡉`, `⡏⠙`, `⠋⠹`,
		`⠈⢹`, `⠀⣸`, `⢀⣠`, `⣀⡀`, `⡄⠀`,

		`⠂⠀`,
		`⠉⠀`, `⠈⠉`, `⠀⠹`, `⠀⣸`, `⣀⣰`,
		`⣆⣠`, `⣏⣀`, `⣏⡉`, `⣏⠹`, `⡏⣹`,
		`⣏⣹`,
		`⣏⣱`, `⣏⣉`, `⣏⠙`, `⠏⠹`, `⠉⢹`,
		`⠀⣹`, `⢀⣰`, `⣀⣀`, `⣄⠀`, `⠆⠀`,
	}
)
